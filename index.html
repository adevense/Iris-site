<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Suporte ao Mestre</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h3>Mestre RPG</h3>
                <p>Bem-vindo(a), <span id="sidebarUserName"></span>!</p>
            </div>
            <nav class="sidebar-nav">
                <ul>
                    <li><a href="#" class="sidebar-link active" data-target="ficha-content">Ficha de Personagem</a></li>
                    <li><a href="#" class="sidebar-link" data-target="anotacoes-content">Anotações</a></li>
                    <li><a href="#" class="sidebar-link" data-target="iniciativa-content">Iniciativa</a></li>
                    <li><a href="#" class="sidebar-link" data-target="hora-data-content">Hora/Data da Campanha</a></li>
                    <li><a href="#" class="sidebar-link" data-target="mensagem-mestre-content">Mensagem Direta para Mestre</a></li>
                    <!-- Novo link da sidebar para Resumo das Sessões -->
                    <li><a href="#" class="sidebar-link" data-target="session-summaries-content">Resumo das Sessões</a></li>
                    <!-- Link da sidebar para Administração (visível apenas para admins via JS) -->
                    <li id="adminSidebarLink" style="display:none;"><a href="#" class="sidebar-link" data-target="admin-content">Administração</a></li>
                </ul>
            </nav>
            <div class="sidebar-footer">
                <button id="logoutButton">Sair</button>
            </div>
        </aside>

        <main class="content">
            <header class="navbar">
                <h1>Painel de Controle</h1>
                <div id="sessionStatusDisplay" class="session-status-display">
                    <span id="sessionIndicator" class="session-indicator"></span>
                    <span id="sessionStatusText">Carregando status...</span>
                </div>
            </header>

            <section id="ficha-content" class="main-content-area content-section active">
                <h2>Ficha de Personagem</h2>
                <form id="characterSheetForm">
                    <!-- Botão Salvar Ficha movido para o topo -->
                    <button type="button" id="saveSheetButton">Salvar Ficha</button>
                    <p class="feedback-message" id="sheetSaveMessage"></p>

                    <div class="input-group">
                        <label for="fichaNome">Nome do Personagem:</label>
                        <input type="text" id="fichaNome" placeholder="Ex: Sir Kaelen">
                    </div>
                    <div class="input-group">
                        <label for="fichaNomePlayer">Nome do Jogador:</label>
                        <input type="text" id="fichaNomePlayer" placeholder="Seu nome">
                    </div>
                    <div class="input-group">
                        <label for="fichaClasse">Classe:</label>
                        <input type="text" id="fichaClasse" placeholder="Ex: Guerreiro">
                    </div>
                    <div class="input-group">
                        <label for="fichaOrigem">Origem:</label>
                        <input type="text" id="fichaOrigem" placeholder="Ex: Nobre">
                    </div>
                    <div class="input-group">
                        <label for="fichaIdade">Idade:</label>
                        <input type="number" id="fichaIdade" placeholder="25">
                    </div>
                    <div class="input-group">
                        <label for="fichaGenero">Gênero:</label>
                        <input type="text" id="fichaGenero" placeholder="Ex: Masculino">
                    </div>

                    <h3>Atributos</h3>
                    <div class="input-group">
                        <label for="fichaForca">Força:</label>
                        <input type="number" id="fichaForca" value="0">
                    </div>
                    <div class="input-group">
                        <label for="fichaAgilidade">Agilidade:</label>
                        <input type="number" id="fichaAgilidade" value="0">
                    </div>
                    <div class="input-group">
                        <label for="fichaVigor">Vigor:</label>
                        <input type="number" id="fichaVigor" value="0">
                    </div>
                    <div class="input-group">
                        <label for="fichaIntelecto">Intelecto:</label>
                        <input type="number" id="fichaIntelecto" value="0">
                    </div>
                    <div class="input-group">
                        <label for="fichaPresenca">Presença:</label>
                        <input type="number" id="fichaPresenca" value="0">
                    </div>

                    <h3>Pontos</h3>
                    <div class="input-group">
                        <label for="fichaPV">Pontos de Vida (PV):</label>
                        <input type="text" id="fichaPV" placeholder="Ex: 50/50">
                    </div>
                    <div class="input-group">
                        <label for="fichaPS">Pontos de Sanidade (PS):</label>
                        <input type="text" id="fichaPS" placeholder="Ex: 10/10">
                    </div>
                    <div class="input-group">
                        <label for="fichaPE">Pontos de Esforço (PE):</label>
                        <input type="text" id="fichaPE" placeholder="Ex: 5/5">
                    </div>
                    <div class="input-group">
                        <label for="fichaNEX">NEX (%):</label>
                        <input type="number" id="fichaNEX" value="0" placeholder="Ex: 50">
                    </div>
                    <div class="input-group">
                        <label for="fichaResistenciasGerais">Resistências Gerais:</label>
                        <input type="text" id="fichaResistenciasGerais" placeholder="Ex: Balístico 5, Corte 2">
                    </div>

                    <h3>Perícias</h3>
                    <!-- Início do contêiner scrollável para as perícias -->
                    <div id="periciasListContainer" class="scrollable-content">
                        <div class="pericias-grid">
                            <div class="input-group">
                                <label for="periciaAcrobacia">Acrobacia:</label>
                                <input type="number" id="periciaAcrobacia" value="0">
                            </div>
                            <div class="input-group">
                                <label for="periciaAdestramento">Adestramento:</label>
                                <input type="number" id="periciaAdestramento" value="0">
                            </div>
                            <div class="input-group">
                                <label for="periciaArtes">Artes:</label>
                                <input type="number" id="periciaArtes" value="0">
                            </div>
                            <div class="input-group">
                                <label for="periciaAtletismo">Atletismo:</label>
                                <input type="number" id="periciaAtletismo" value="0">
                            </div>
                            <div class="input-group">
                                <label for="periciaAtualidades">Atualidades:</label>
                                <input type="number" id="periciaAtualidades" value="0">
                            </div>
                            <div class="input-group">
                                <label for="periciaCiencias">Ciências:</label>
                                <input type="number" id="periciaCiencias" value="0">
                            </div>
                            <div class="input-group">
                                <label for="periciaCrime">Crime:</label>
                                <input type="number" id="periciaCrime" value="0">
                            </div>
                            <div class="input-group">
                                <label for="periciaDiplomacia">Diplomacia:</label>
                                <input type="number" id="periciaDiplomacia" value="0">
                            </div>
                            <div class="input-group">
                                <label for="periciaEnganacao">Enganação:</label>
                                <input type="number" id="periciaEnganacao" value="0">
                            </div>
                            <div class="input-group">
                                <label for="periciaFortitude">Fortitude:</label>
                                <input type="number" id="periciaFortitude" value="0">
                            </div>
                            <div class="input-group">
                                <label for="periciaFurtividade">Furtividade:</label>
                                <input type="number" id="periciaFurtividade" value="0">
                            </div>
                            <div class="input-group">
                                <label for="periciaIniciativa">Iniciativa:</label>
                                <input type="number" id="periciaIniciativa" value="0">
                            </div>
                            <div class="input-group">
                                <label for="periciaIntimidacao">Intimidação:</label>
                                <input type="number" id="periciaIntimidacao" value="0">
                            </div>
                            <div class="input-group">
                                <label for="periciaIntuicao">Intuição:</label>
                                <input type="number" id="periciaIntuicao" value="0">
                            </div>
                            <div class="input-group">
                                <label for="periciaInvestigacao">Investigação:</label>
                                <input type="number" id="periciaInvestigacao" value="0">
                            </div>
                            <div class="input-group">
                                <label for="periciaLuta">Luta:</label>
                                <input type="number" id="periciaLuta" value="0">
                            </div>
                            <div class="input-group">
                                <label for="periciaMedicina">Medicina:</label>
                                <input type="number" id="periciaMedicina" value="0">
                            </div>
                            <div class="input-group">
                                <label for="periciaOcultismo">Ocultismo:</label>
                                <input type="number" id="periciaOcultismo" value="0">
                            </div>
                            <div class="input-group">
                                <label for="periciaPercepcao">Percepção:</label>
                                <input type="number" id="periciaPercepcao" value="0">
                            </div>
                            <div class="input-group">
                                <label for="periciaPilotagem">Pilotagem:</label>
                                <input type="number" id="periciaPilotagem" value="0">
                            </div>
                            <div class="input-group">
                                <label for="periciaPontaria">Pontaria:</label>
                                <input type="number" id="periciaPontaria" value="0">
                            </div>
                            <div class="input-group">
                                <label for="periciaProfissao">Profissão:</label>
                                <input type="number" id="periciaProfissao" value="0">
                            </div>
                            <div class="input-group">
                                <label for="periciaReflexos">Reflexos:</label>
                                <input type="number" id="periciaReflexos" value="0">
                            </div>
                            <div class="input-group">
                                <label for="periciaReligiao">Religião:</label>
                                <input type="number" id="periciaReligiao" value="0">
                            </div>
                            <div class="input-group">
                                <label for="periciaSobrevivencia">Sobrevivência:</label>
                                <input type="number" id="periciaSobrevivencia" value="0">
                            </div>
                            <div class="input-group">
                                <label for="periciaTatica">Tática:</label>
                                <input type="number" id="periciaTatica" value="0">
                            </div>
                            <div class="input-group">
                                <label for="periciaTecnologia">Tecnologia:</label>
                                <input type="number" id="periciaTecnologia" value="0">
                            </div>
                            <div class="input-group">
                                <label for="periciaVontade">Vontade:</label>
                                <input type="number" id="periciaVontade" value="0">
                            </div>
                        </div>
                    </div>
                    <!-- Fim do contêiner scrollável para as perícias -->

                    <h3>Habilidades</h3>
                    <div class="input-group">
                        <label for="fichaHabilidades">Habilidades, Rituais e Poderes:</label>
                        <textarea id="fichaHabilidades" rows="5" placeholder="Descreva suas habilidades, rituais e poderes."></textarea>
                    </div>

                    <div id="rituaisListContainer">
                        <!-- Rituais serão adicionados aqui dinamicamente -->
                    </div>
                    <button type="button" id="addRitualButton">Adicionar Ritual/Poder</button>

                    <h3>Inventário e Equipamento</h3>
                    <div class="input-group">
                        <label for="fichaEquipamentos">Equipamentos:</label>
                        <textarea id="fichaEquipamentos" rows="5" placeholder="Liste seus equipamentos."></textarea>
                    </div>
                    <div class="input-group">
                        <label for="fichaDinheiro">Dinheiro:</label>
                        <input type="text" id="fichaDinheiro" placeholder="Ex: 500 PO">
                    </div>
                    <div class="input-group">
                        <label for="fichaLimiteInventario">Limite de Inventário:</label>
                        <input type="text" id="fichaLimiteInventario" placeholder="Ex: Leve/Normal/Pesado">
                    </div>
                    <div class="input-group">
                        <label for="fichaClasseItens">Classe de Itens:</label>
                        <input type="text" id="fichaClasseItens" placeholder="Ex: I, II, III, IV">
                    </div>

                    <h3>Aparência e História</h3>
                    <div class="input-group">
                        <label for="fichaApariencia">Aparência:</label>
                        <textarea id="fichaApariencia" rows="5" placeholder="Descreva a aparência do seu personagem."></textarea>
                    </div>
                    <div class="input-group">
                        <label for="fichaHistoria">História:</label>
                        <textarea id="fichaHistoria" rows="8" placeholder="Escreva a história do seu personagem."></textarea>
                    </div>
                </form>
            </section>

            <section id="anotacoes-content" class="main-content-area content-section">
                <h2>Minhas Anotações</h2>
                <div class="input-group">
                    <label for="notesTextArea">Anotações:</label>
                    <textarea id="notesTextArea" rows="15" placeholder="Escreva suas anotações aqui..."></textarea>
                </div>
                <button id="saveNoteButton">Salvar Anotação</button>
                <p class="feedback-message" id="saveMessage"></p>
            </section>

            <section id="iniciativa-content" class="main-content-area content-section">
                <h2>Controle de Iniciativa</h2>
                <div class="input-group">
                    <label for="initiativeValue">Sua Iniciativa:</label>
                    <input type="number" id="initiativeValue" placeholder="Insira seu valor de iniciativa">
                </div>
                <button id="addInitiativeButton">Atualizar Minha Iniciativa</button>
                <p class="feedback-message" id="adminMessage"></p>

                <h3>Ordem de Iniciativa</h3>
                <div id="initiativeListContainer" class="list-container">
                    <!-- Lista de iniciativas será carregada aqui -->
                </div>
                <div id="adminControls" class="admin-controls" style="display:none;">
                    <button id="clearInitiativeButton">Limpar Todas as Iniciativas</button>
                </div>
            </section>

            <section id="hora-data-content" class="main-content-area content-section">
                <h2>Hora e Data da Campanha</h2>
                <p>Data Atual: <strong id="displayCampaignDate">Carregando...</strong></p>
                <p>Hora Atual: <strong id="displayCampaignTime">Carregando...</strong></p>

                <div id="timeDateAdminSection" class="admin-section" style="display:none;">
                    <h3>Controles do Mestre</h3>
                    <div class="input-group">
                        <label for="campaignDateInput">Definir Data:</label>
                        <input type="text" id="campaignDateInput" placeholder="Ex: 25 de Agorosto, Ano 4720">
                    </div>
                    <div class="input-group">
                        <label for="campaignTimeInput">Definir Hora:</label>
                        <input type="text" id="campaignTimeInput" placeholder="Ex: 14:30">
                    </div>
                    <button id="saveTimeDateButton">Salvar Hora/Data</button>
                    <p class="feedback-message" id="timeDateMessage"></p>
                </div>
            </section>

            <section id="mensagem-mestre-content" class="main-content-area content-section">
                <h2>Mensagem Direta para o Mestre</h2>
                <div class="master-message-input-area">
                    <!-- Nova div para mostrar o contexto de resposta -->
                    <div id="replyingToMessage" class="reply-context" style="display:none;">
                        A responder a: <span id="replyToSenderName"></span> <button id="cancelReplyButton" class="cancel-reply-btn">X</button>
                    </div>
                    <div class="master-message-input-wrapper">
                        <textarea id="masterMessageInput" placeholder="Digite sua mensagem para o Mestre..."></textarea>
                        <button id="sendMasterMessageButton">Enviar Mensagem</button>
                    </div>
                    <p class="feedback-message" id="masterMessageFeedback"></p>
                    <div id="masterMessageAdminControls" class="admin-controls" style="display:none;">
                        <button id="clearMasterMessagesButton">Limpar Todas as Mensagens</button>
                    </div>
                </div>
                <div id="masterMessagesDisplay" class="messages-display">
                    <!-- Mensagens serão carregadas aqui -->
                </div>
            </section>

            <!-- Nova Seção de Resumo das Sessões (visível para todos autenticados) -->
            <section id="session-summaries-content" class="main-content-area content-section">
                <h2>Resumo das Sessões</h2>
                <p>Aqui você pode ver os resumos das sessões anteriores, criados pelo Mestre.</p>
                <div id="sessionSummariesList" class="messages-display">
                    <!-- Resumos de sessão serão carregados aqui pelo JavaScript -->
                    <p style="text-align: center; color: #777;">Nenhum resumo de sessão disponível ainda.</p>
                </div>
            </section>

            <!-- Seção de Administração (visível apenas para admins via JS) -->
            <section id="admin-content" class="main-content-area content-section" style="display:none;">
                <h2>Administração do Mestre</h2>
                <p>Aqui você pode gerenciar as configurações gerais da campanha.</p>

                <div class="admin-section-item">
                    <h3>Status da Sessão</h3>
                    <p>Alterne para indicar se a sessão de jogo está ativa ou inativa para os jogadores.</p>
                    <label class="switch">
                        <input type="checkbox" id="sessionToggleButton">
                        <span class="slider round"></span>
                    </label>
                    <span id="adminSessionStatusText">Carregando...</span>
                </div>

                <div class="admin-section-item">
                    <h3>Resumo de Nova Sessão</h3>
                    <div class="input-group">
                        <label for="sessionSummaryTitle">Título da Sessão:</label>
                        <input type="text" id="sessionSummaryTitle" placeholder="Ex: A Aventura na Floresta Sombria">
                    </div>
                    <div class="input-group">
                        <label for="sessionSummaryContent">Conteúdo do Resumo:</label>
                        <textarea id="sessionSummaryContent" rows="8" placeholder="Descreva os eventos importantes desta sessão..."></textarea>
                    </div>
                    <button id="saveSessionSummaryButton">Salvar Resumo da Sessão</button>
                    <p class="feedback-message" id="sessionSummaryMessage"></p>
                </div>

                <div class="admin-section-item">
                    <h3>Jogadores e Personagens</h3>
                    <p>Lista de todos os jogadores e seus personagens registados.</p>
                    <div id="playersCharactersList" class="list-container">
                        <!-- Lista de jogadores/personagens será carregada aqui pelo JavaScript -->
                        <p style="text-align: center; color: #777;">Nenhum jogador/personagem encontrado.</p>
                    </div>
                </div>

                <div class="admin-section-item">
                    <h3>Gerenciamento de Administradores</h3>
                    <p>Você pode adicionar ou remover UIDs de utilizadores que terão acesso a recursos de Mestre. Para adicionar ou remover UIDs, por favor, edite a coleção `adminUsers` diretamente no seu Console do Firebase.</p>
                </div>
            </section>
        </main>
    </div>

    <!-- O script.js é carregado como um módulo e contém toda a lógica do Firebase -->
    <script type="module" src="script.js"></script>
</body>
</html>
